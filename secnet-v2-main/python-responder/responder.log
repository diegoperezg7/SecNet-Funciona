nohup: no se tendr√° en cuenta la entrada
2025-06-05 13:32:41,583 - responder - INFO - Base de datos inicializada en /home/secnet/Descargas/secnet-v2-main/database/alerts.db
2025-06-05 13:32:41,591 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-05 13:32:41,613 - responder - INFO - Servidor Flask iniciado en el puerto 5000
 * Serving Flask app 'responder'
 * Debug mode: off
2025-06-05 13:32:41,671 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-05 13:32:41,671 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-05 15:35:07,568 - werkzeug - INFO - 127.0.0.1 - - [05/Jun/2025 15:35:07] "[31m[1mPOST /api/block-ip HTTP/1.1[0m" 400 -
(0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-05 13:32:41,671 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-05 15:35:07,568 - werkzeug - INFO - 127.0.0.1 - - [05/Jun/2025 15:35:07] "[31m[1mPOST /api/block-ip HTTP/1.1[0m" 400 -
2025-06-05 18:26:00,278 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-05 18:26:00,278 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-05T18:26:00.278281)
2025-06-05 18:26:00,282 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-05 18:26:00,285 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-05 18:26:00,325 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-05 18:26:00,326 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-05 18:30:33,880 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-05 18:30:33,885 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-05T18:30:33.885630)
2025-06-05 18:30:33,887 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-05 18:30:33,888 - responder - INFO - Posici√≥n inicial del archivo: 17472
2025-06-05 18:30:33,895 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-05 18:30:33,904 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-05 18:30:33,934 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-05 18:30:33,935 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-05 18:34:41,116 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-05 18:34:41,119 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-05T18:34:41.119930)
2025-06-05 18:34:41,120 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-05 18:34:41,120 - responder - INFO - Posici√≥n inicial del archivo: 17472
2025-06-05 18:34:41,129 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-05 18:34:41,141 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-05 18:34:41,177 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-05 18:34:41,178 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-05 18:39:17,039 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-05 18:39:17,040 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-05T18:39:17.040125)
2025-06-05 18:39:17,041 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-05 18:39:17,041 - responder - INFO - Posici√≥n inicial del archivo: 17472
2025-06-05 18:39:17,044 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-05 18:39:17,051 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-05 18:39:17,083 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-05 18:39:17,083 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-05 18:40:57,472 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-05 18:40:57,472 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-05T18:40:57.472745)
2025-06-05 18:40:57,472 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-05 18:40:57,473 - responder - INFO - Posici√≥n inicial del archivo: 17472
2025-06-05 18:40:57,475 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-05 18:40:57,476 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-05 18:40:57,494 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-05 18:40:57,494 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-05 18:42:26,960 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-05 18:42:26,961 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-05T18:42:26.961833)
2025-06-05 18:42:26,962 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-05 18:42:26,962 - responder - INFO - Posici√≥n inicial del archivo: 17472
2025-06-05 18:42:26,965 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-05 18:42:26,970 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-05 18:42:27,013 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-05 18:42:27,013 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-05 18:48:37,577 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-05 18:48:37,594 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-05 18:48:37,597 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-05T20:48:37.547373+0200",
  "flow_id": 1506526110126825,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 39181,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-05T20:48:37.547373+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 39181,
    "dest_port": 80
  }
}
2025-06-05 18:48:37,598 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-05 18:48:37,598 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Actividad sospechosa]
2025-06-05 18:48:37,674 - responder - ERROR - Error en block_ip() para IP 192.168.56.5: [Errno 2] No such file or directory: 'docker'
Traceback (most recent call last):
  File "/app/responder.py", line 184, in block_ip
    success, _ = run_command(cmd)
  File "/app/responder.py", line 164, in run_command
    result = subprocess.run(cmd, capture_output=True, text=True, check=True)
  File "/usr/local/lib/python3.9/subprocess.py", line 505, in run
    with Popen(*popenargs, **kwargs) as process:
  File "/usr/local/lib/python3.9/subprocess.py", line 951, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/lib/python3.9/subprocess.py", line 1837, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: 'docker'
2025-06-05 18:48:37,679 - responder - ERROR - No se pudo bloquear la IP: 192.168.56.5
2025-06-05 18:48:37,691 - responder - INFO - Alerta guardada en la base de datos: 14
2025-06-05 18:48:37,704 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: Error bloqueando IP: 192.168.56.5
2025-06-05 18:51:42,174 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-05 18:51:42,176 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-05T18:51:42.176099)
2025-06-05 18:51:42,176 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-05 18:51:42,176 - responder - INFO - Posici√≥n inicial del archivo: 18091
2025-06-05 18:51:42,178 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-05 18:51:42,180 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-05 18:51:42,214 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-05 18:51:42,214 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-05 19:17:43,045 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-05 19:17:43,046 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-05T19:17:43.046131)
2025-06-05 19:17:43,046 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-05 19:17:43,046 - responder - INFO - Posici√≥n inicial del archivo: 18091
2025-06-05 19:17:43,048 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-05 19:17:43,051 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-05 19:17:43,084 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-05 19:17:43,085 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 09:20:51,216 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 09:20:51,220 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T09:20:51.220278)
2025-06-06 09:20:51,220 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 09:20:51,222 - responder - INFO - Posici√≥n inicial del archivo: 18091
2025-06-06 09:20:51,228 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 09:20:51,230 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 09:20:51,342 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 09:20:51,342 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 09:29:05,668 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 09:29:05,669 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T09:29:05.669716)
2025-06-06 09:29:05,670 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 09:29:05,671 - responder - INFO - Posici√≥n inicial del archivo: 18091
2025-06-06 09:29:05,694 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 09:29:05,697 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 09:29:05,790 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 09:29:05,790 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 09:31:40,711 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 09:31:40,714 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T09:31:40.714143)
2025-06-06 09:31:40,714 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 09:31:40,715 - responder - INFO - Posici√≥n inicial del archivo: 18091
2025-06-06 09:31:40,723 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 09:31:40,728 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 09:31:40,825 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 09:31:40,825 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 09:34:04,469 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 09:34:04,615 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 09:34:04,623 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T11:34:04.338907+0200",
  "flow_id": 1174120118867077,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 61428,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T11:34:04.338907+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 61428,
    "dest_port": 80
  }
}
2025-06-06 09:34:04,628 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 09:34:04,628 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Actividad sospechosa]
2025-06-06 09:34:04,637 - responder - INFO - IP 192.168.56.5 ya est√° bloqueada (registro encontrado en BD)
2025-06-06 09:34:04,639 - responder - WARNING - IP bloqueada autom√°ticamente: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port
2025-06-06 09:34:04,782 - responder - INFO - Alerta guardada en la base de datos: 15
2025-06-06 09:34:04,875 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP Bloqueada: 192.168.56.5
2025-06-06 09:40:05,892 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 09:40:05,908 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T09:40:05.906277)
2025-06-06 09:40:05,908 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 09:40:05,908 - responder - INFO - Posici√≥n inicial del archivo: 18710
2025-06-06 09:40:05,923 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 09:40:05,927 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 09:40:06,020 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 09:40:06,021 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 09:46:03,463 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 09:46:03,481 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T09:46:03.480755)
2025-06-06 09:46:03,481 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 09:46:03,482 - responder - INFO - Posici√≥n inicial del archivo: 18710
2025-06-06 09:46:03,537 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 09:46:03,548 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 09:46:03,636 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 09:46:03,636 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 10:27:05,358 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 10:27:05,358 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T10:27:05.358484)
2025-06-06 10:27:05,358 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 10:27:05,358 - responder - INFO - Posici√≥n inicial del archivo: 18710
2025-06-06 10:27:05,362 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 10:27:05,363 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 10:27:05,373 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 10:27:05,373 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 10:28:03,308 - responder - INFO - Base de datos inicializada en /var/www/html/database/alerts.db
2025-06-06 10:28:03,308 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T10:28:03.308922)
2025-06-06 10:28:03,309 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 10:28:03,309 - responder - INFO - Posici√≥n inicial del archivo: 18710
2025-06-06 10:28:03,313 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 10:28:03,316 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 10:28:03,362 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 10:28:03,363 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 10:28:34,543 - responder - INFO - Base de datos inicializada en /var/www/html/database/alerts.db
2025-06-06 10:28:34,543 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T10:28:34.543546)
2025-06-06 10:28:34,543 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 10:28:34,543 - responder - INFO - Posici√≥n inicial del archivo: 18710
2025-06-06 10:28:34,574 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 10:28:34,600 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 10:28:34,621 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 10:28:34,626 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 10:39:36,282 - responder - INFO - Inicializando base de datos en: /var/www/html/database/alerts.db
2025-06-06 10:39:36,282 - responder - INFO - Permisos establecidos en directorio: /var/www/html/database
2025-06-06 10:39:36,282 - responder - INFO - Conectando a la base de datos: /var/www/html/database/alerts.db
2025-06-06 10:39:36,283 - responder - INFO - Conexi√≥n a la base de datos exitosa
2025-06-06 10:39:36,283 - responder - INFO - Permisos establecidos en archivo: /var/www/html/database/alerts.db
2025-06-06 10:39:36,283 - responder - INFO - Creando tablas en la base de datos...
2025-06-06 10:39:36,283 - responder - INFO - Tablas creadas exitosamente
2025-06-06 10:39:36,283 - responder - INFO - Base de datos inicializada en /var/www/html/database/alerts.db
2025-06-06 10:39:36,283 - responder - INFO - Conexi√≥n a la base de datos cerrada
2025-06-06 10:39:36,284 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T10:39:36.283960)
2025-06-06 10:39:36,284 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 10:39:36,284 - responder - INFO - Posici√≥n inicial del archivo: 18710
2025-06-06 10:39:36,299 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 10:39:36,348 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 10:39:36,416 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 10:39:36,416 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 10:46:51,149 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 10:46:51,150 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T10:46:51.150413)
2025-06-06 10:46:51,150 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 10:46:51,150 - responder - INFO - Posici√≥n inicial del archivo: 18710
2025-06-06 10:46:51,155 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 10:46:51,163 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 10:46:51,182 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 10:46:51,183 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 10:49:27,041 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 10:49:27,042 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T10:49:27.042014)
2025-06-06 10:49:27,042 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 10:49:27,042 - responder - INFO - Posici√≥n inicial del archivo: 18710
2025-06-06 10:49:27,049 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 10:49:27,051 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 10:49:27,081 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 10:49:27,082 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 10:55:12,342 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 10:55:12,345 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T10:55:12.345081)
2025-06-06 10:55:12,345 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 10:55:12,345 - responder - INFO - Posici√≥n inicial del archivo: 18710
2025-06-06 10:55:12,348 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 10:55:12,349 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 10:55:12,387 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 10:55:12,388 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 10:57:34,162 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 10:57:34,203 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 10:57:34,204 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T12:57:34.150469+0200",
  "flow_id": 1772159653227011,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 35366,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T12:57:34.150469+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 35366,
    "dest_port": 80
  }
}
2025-06-06 10:57:34,204 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 10:57:34,291 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Actividad sospechosa]
2025-06-06 10:57:34,406 - responder - ERROR - Error al ejecutar comando which iptables-persistent: Command '['which', 'iptables-persistent']' returned non-zero exit status 1.
2025-06-06 10:57:34,419 - responder - ERROR - Error al ejecutar comando which netfilter-persistent: Command '['which', 'netfilter-persistent']' returned non-zero exit status 1.
2025-06-06 10:57:34,437 - responder - ERROR - Error al ejecutar comando sh -c iptables-save > /etc/iptables/rules.v4: sh: 1: cannot create /etc/iptables/rules.v4: Directory nonexistent

2025-06-06 10:57:34,438 - responder - WARNING - No se pudo guardar las reglas de iptables de forma persistente
2025-06-06 10:57:34,438 - responder - INFO - IP 192.168.56.5 bloqueada correctamente
2025-06-06 10:57:34,438 - responder - WARNING - IP bloqueada autom√°ticamente: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port
2025-06-06 10:57:34,553 - responder - INFO - Alerta guardada en la base de datos: 16
2025-06-06 10:57:34,590 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP Bloqueada: 192.168.56.5
2025-06-06 10:58:32,924 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 10:58:32,924 - responder - INFO - Procesando nueva alerta: SSH Brute Force Attempt
2025-06-06 10:58:32,925 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T12:58:32.902446+0200",
  "flow_id": 216802801246433,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 53388,
  "dest_ip": "192.168.56.4",
  "dest_port": 22,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000001,
    "rev": 2,
    "signature": "SSH Brute Force Attempt",
    "category": "Attempted Administrator Privilege Gain",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T12:58:32.902446+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 53388,
    "dest_port": 22
  }
}
2025-06-06 10:58:32,925 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Amenaza confirmada, gravedad=3, should_block=True
2025-06-06 10:58:32,940 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 10:58:33,009 - responder - INFO - Alerta guardada en la base de datos: 17
2025-06-06 10:58:33,037 - responder - INFO - Alerta procesada: SSH Brute Force Attempt | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 10:58:34,024 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 10:58:34,028 - responder - INFO - Procesando nueva alerta: SSH Brute Force Attempt
2025-06-06 10:58:34,028 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T12:58:34.008921+0200",
  "flow_id": 601265675793914,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 53390,
  "dest_ip": "192.168.56.4",
  "dest_port": 22,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000001,
    "rev": 2,
    "signature": "SSH Brute Force Attempt",
    "category": "Attempted Administrator Privilege Gain",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T12:58:34.008921+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 53390,
    "dest_port": 22
  }
}
2025-06-06 10:58:34,028 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Amenaza confirmada, gravedad=3, should_block=True
2025-06-06 10:58:34,037 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 10:58:34,112 - responder - INFO - Alerta guardada en la base de datos: 18
2025-06-06 10:58:34,136 - responder - INFO - Alerta procesada: SSH Brute Force Attempt | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 10:58:34,141 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 10:58:34,144 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 10:58:34,145 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T12:58:34.108884+0200",
  "flow_id": 749128566096833,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 53388,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T12:58:34.108884+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 53388,
    "dest_port": 80
  }
}
2025-06-06 10:58:34,145 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 10:58:34,164 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 10:58:34,232 - responder - INFO - Alerta guardada en la base de datos: 19
2025-06-06 10:58:34,252 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 10:58:34,255 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 10:58:34,255 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 10:58:34,257 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T12:58:34.210729+0200",
  "flow_id": 623602013510319,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 53390,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T12:58:34.210729+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 53390,
    "dest_port": 80
  }
}
2025-06-06 10:58:34,257 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 10:58:34,266 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 10:58:34,323 - responder - INFO - Alerta guardada en la base de datos: 20
2025-06-06 10:58:34,349 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 11:00:41,812 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 11:00:41,815 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T11:00:41.815571)
2025-06-06 11:00:41,815 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 11:00:41,816 - responder - INFO - Posici√≥n inicial del archivo: 21829
2025-06-06 11:00:41,819 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 11:00:41,820 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 11:00:41,853 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 11:00:41,854 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 11:10:30,044 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 11:10:30,045 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T11:10:30.045122)
2025-06-06 11:10:30,045 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 11:10:30,045 - responder - INFO - Posici√≥n inicial del archivo: 21829
2025-06-06 11:10:30,047 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 11:10:30,049 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 11:10:30,084 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 11:10:30,084 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 11:21:53,548 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 11:21:53,549 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T11:21:53.549966)
2025-06-06 11:21:53,550 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 11:21:53,550 - responder - INFO - Posici√≥n inicial del archivo: 21829
2025-06-06 11:21:53,552 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 11:21:53,555 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 11:21:53,585 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 11:21:53,585 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 11:24:33,307 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 11:24:33,309 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T11:24:33.309793)
2025-06-06 11:24:33,309 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 11:24:33,310 - responder - INFO - Posici√≥n inicial del archivo: 21829
2025-06-06 11:24:33,318 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 11:24:33,339 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 11:24:33,359 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 11:24:33,360 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 11:24:44,394 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 11:24:44,404 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 11:24:44,405 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T13:24:44.375966+0200",
  "flow_id": 1333288785580004,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 53358,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T13:24:44.375966+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 53358,
    "dest_port": 80
  }
}
2025-06-06 11:24:44,406 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 11:24:44,431 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Actividad sospechosa]
2025-06-06 11:24:44,534 - responder - INFO - IP 192.168.56.5 bloqueada correctamente en iptables
2025-06-06 11:24:44,534 - responder - WARNING - IP bloqueada autom√°ticamente: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port
2025-06-06 11:24:44,605 - responder - INFO - Alerta guardada en la base de datos: 21
2025-06-06 11:24:44,634 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP Bloqueada: 192.168.56.5
2025-06-06 11:25:27,800 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 11:25:27,800 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 11:25:27,801 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T13:25:27.787185+0200",
  "flow_id": 1973560004904947,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 42383,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T13:25:27.787185+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 42383,
    "dest_port": 80
  }
}
2025-06-06 11:25:27,801 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 11:25:27,806 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 11:25:27,820 - responder - INFO - Alerta guardada en la base de datos: 22
2025-06-06 11:25:27,828 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 11:25:28,909 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 11:25:28,910 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 11:25:28,910 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T13:25:28.890928+0200",
  "flow_id": 167335525856771,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 42385,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T13:25:28.890928+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 42385,
    "dest_port": 80
  }
}
2025-06-06 11:25:28,910 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 11:25:28,925 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 11:25:28,989 - responder - INFO - Alerta guardada en la base de datos: 23
2025-06-06 11:25:29,006 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 11:25:29,012 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 11:25:29,017 - responder - INFO - Procesando nueva alerta: SSH Brute Force Attempt
2025-06-06 11:25:29,018 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T13:25:28.994518+0200",
  "flow_id": 49299969157156,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 42383,
  "dest_ip": "192.168.56.4",
  "dest_port": 22,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000001,
    "rev": 2,
    "signature": "SSH Brute Force Attempt",
    "category": "Attempted Administrator Privilege Gain",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T13:25:28.994518+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 42383,
    "dest_port": 22
  }
}
2025-06-06 11:25:29,020 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Amenaza confirmada, gravedad=3, should_block=True
2025-06-06 11:25:29,030 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 11:25:29,086 - responder - INFO - Alerta guardada en la base de datos: 24
2025-06-06 11:25:29,104 - responder - INFO - Alerta procesada: SSH Brute Force Attempt | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 11:25:29,117 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 11:25:29,121 - responder - INFO - Procesando nueva alerta: SSH Brute Force Attempt
2025-06-06 11:25:29,124 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T13:25:29.098613+0200",
  "flow_id": 423539634696494,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 42385,
  "dest_ip": "192.168.56.4",
  "dest_port": 22,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000001,
    "rev": 2,
    "signature": "SSH Brute Force Attempt",
    "category": "Attempted Administrator Privilege Gain",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T13:25:29.098613+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 42385,
    "dest_port": 22
  }
}
2025-06-06 11:25:29,125 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Amenaza confirmada, gravedad=3, should_block=True
2025-06-06 11:25:29,145 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 11:25:29,226 - responder - INFO - Alerta guardada en la base de datos: 25
2025-06-06 11:25:29,252 - responder - INFO - Alerta procesada: SSH Brute Force Attempt | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 11:33:55,957 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 11:33:55,958 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T11:33:55.958674)
2025-06-06 11:33:55,958 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 11:33:55,958 - responder - INFO - Posici√≥n inicial del archivo: 24948
2025-06-06 11:33:55,960 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 11:33:55,961 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 11:33:55,988 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 11:33:55,988 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 11:48:18,392 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 11:48:18,392 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T11:48:18.392503)
2025-06-06 11:48:18,392 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 11:48:18,392 - responder - INFO - Posici√≥n inicial del archivo: 24948
2025-06-06 11:48:18,396 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 11:48:18,398 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 11:48:18,419 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 11:48:18,419 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 11:52:15,727 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 11:52:15,730 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T11:52:15.730371)
2025-06-06 11:52:15,730 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 11:52:15,730 - responder - INFO - Posici√≥n inicial del archivo: 24948
2025-06-06 11:52:15,732 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 11:52:15,735 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 11:52:15,763 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 11:52:15,763 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 11:56:14,596 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 11:56:14,608 - responder - INFO - Procesando nueva alerta: SSH Brute Force Attempt
2025-06-06 11:56:14,608 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T13:56:14.578529+0200",
  "flow_id": 1921814620244541,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 64816,
  "dest_ip": "192.168.56.4",
  "dest_port": 22,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000001,
    "rev": 2,
    "signature": "SSH Brute Force Attempt",
    "category": "Attempted Administrator Privilege Gain",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T13:56:14.578529+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 64816,
    "dest_port": 22
  }
}
2025-06-06 11:56:14,610 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Amenaza confirmada, gravedad=3, should_block=True
2025-06-06 11:56:14,616 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 11:56:14,680 - responder - INFO - Alerta guardada en la base de datos: 26
2025-06-06 11:56:14,720 - responder - INFO - Alerta procesada: SSH Brute Force Attempt | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 11:56:14,902 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 11:56:14,904 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 11:56:14,904 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T13:56:14.887482+0200",
  "flow_id": 1841385156959303,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 64814,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T13:56:14.887482+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 64814,
    "dest_port": 80
  }
}
2025-06-06 11:56:14,912 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 11:56:14,923 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 11:56:15,000 - responder - INFO - Alerta guardada en la base de datos: 27
2025-06-06 11:56:15,020 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 11:56:15,023 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 11:56:15,025 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 11:56:15,025 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T13:56:14.988245+0200",
  "flow_id": 1711205215621898,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 64816,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T13:56:14.988245+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 64816,
    "dest_port": 80
  }
}
2025-06-06 11:56:15,029 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 11:56:15,040 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 11:56:15,100 - responder - INFO - Alerta guardada en la base de datos: 28
2025-06-06 11:56:15,116 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 11:58:23,319 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 11:58:23,322 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T11:58:23.322664)
2025-06-06 11:58:23,322 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 11:58:23,322 - responder - INFO - Posici√≥n inicial del archivo: 26819
2025-06-06 11:58:23,325 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 11:58:23,327 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 11:58:23,357 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 11:58:23,358 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:07:13,205 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:07:13,205 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:07:13.205505)
2025-06-06 12:07:13,205 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:07:13,205 - responder - INFO - Posici√≥n inicial del archivo: 26819
2025-06-06 12:07:13,207 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:07:13,208 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:07:13,218 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 12:07:13,219 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:07:17,659 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 12:07:17,669 - responder - INFO - Procesando nueva alerta: ICMP Ping
2025-06-06 12:07:17,672 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T14:07:17.656134+0200",
  "flow_id": 1410699968006868,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "10.0.2.15",
  "dest_ip": "192.168.56.4",
  "proto": "ICMP",
  "icmp_type": 13,
  "icmp_code": 0,
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000009,
    "rev": 2,
    "signature": "ICMP Ping",
    "category": "Detection of a Network Scan",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 54,
    "bytes_toclient": 0,
    "start": "2025-06-06T14:07:17.656134+0200",
    "src_ip": "10.0.2.15",
    "dest_ip": "192.168.56.4"
  }
}
2025-06-06 12:07:17,673 - responder - INFO - Evaluando bloqueo para 10.0.2.15: categoria=Amenaza confirmada, gravedad=3, should_block=False
2025-06-06 12:07:17,734 - responder - INFO - Alerta guardada en la base de datos: 29
2025-06-06 12:07:17,741 - responder - INFO - Alerta procesada: ICMP Ping | Src: 10.0.2.15 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: Registrado
2025-06-06 12:07:17,906 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 12:07:17,908 - responder - INFO - Procesando nueva alerta: SSH Brute Force Attempt
2025-06-06 12:07:17,908 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T14:07:17.896214+0200",
  "flow_id": 1597413902946822,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "10.0.2.15",
  "src_port": 57161,
  "dest_ip": "192.168.56.4",
  "dest_port": 22,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000001,
    "rev": 2,
    "signature": "SSH Brute Force Attempt",
    "category": "Attempted Administrator Privilege Gain",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 58,
    "bytes_toclient": 0,
    "start": "2025-06-06T14:07:17.896214+0200",
    "src_ip": "10.0.2.15",
    "dest_ip": "192.168.56.4",
    "src_port": 57161,
    "dest_port": 22
  }
}
2025-06-06 12:07:17,908 - responder - INFO - Evaluando bloqueo para 10.0.2.15: categoria=Amenaza confirmada, gravedad=3, should_block=False
2025-06-06 12:07:17,974 - responder - INFO - Alerta guardada en la base de datos: 30
2025-06-06 12:07:17,993 - responder - INFO - Alerta procesada: SSH Brute Force Attempt | Src: 10.0.2.15 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: Registrado
2025-06-06 12:08:33,805 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:08:33,808 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:08:33.808433)
2025-06-06 12:08:33,809 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:08:33,809 - responder - INFO - Posici√≥n inicial del archivo: 28014
2025-06-06 12:08:33,817 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:08:33,825 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:08:33,850 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 12:08:33,852 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:12:03,830 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:12:03,830 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:12:03.830392)
2025-06-06 12:12:03,830 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:12:03,830 - responder - INFO - Posici√≥n inicial del archivo: 28014
2025-06-06 12:12:03,839 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:12:03,848 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:12:03,922 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 12:12:03,926 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:12:14,500 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 12:12:14,586 - responder - INFO - Procesando nueva alerta: ICMP Ping
2025-06-06 12:12:14,593 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T14:12:14.491503+0200",
  "flow_id": 1829515422241357,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "10.0.2.15",
  "dest_ip": "192.168.56.4",
  "proto": "ICMP",
  "icmp_type": 13,
  "icmp_code": 0,
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000009,
    "rev": 2,
    "signature": "ICMP Ping",
    "category": "Detection of a Network Scan",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 54,
    "bytes_toclient": 0,
    "start": "2025-06-06T14:12:14.491503+0200",
    "src_ip": "10.0.2.15",
    "dest_ip": "192.168.56.4"
  }
}
2025-06-06 12:12:14,594 - responder - INFO - IP 10.0.2.15 marcada para bloqueo por actividad maliciosa: ICMP Ping
2025-06-06 12:12:14,595 - responder - INFO - Evaluando bloqueo para 10.0.2.15: categoria=Amenaza confirmada, gravedad=3, should_block=True
2025-06-06 12:12:14,636 - responder - INFO - Intentando bloquear IP: 10.0.2.15 - Raz√≥n: ICMP Ping [Amenaza confirmada]
2025-06-06 12:12:14,750 - responder - INFO - Intentando insertar IP 10.0.2.15 en la base de datos...
2025-06-06 12:12:14,979 - responder - INFO - IP 10.0.2.15 insertada correctamente en la base de datos
2025-06-06 12:12:15,197 - responder - INFO - IP 10.0.2.15 bloqueada correctamente en iptables
2025-06-06 12:12:15,215 - responder - WARNING - IP bloqueada autom√°ticamente: 10.0.2.15 - Raz√≥n: ICMP Ping
2025-06-06 12:12:15,505 - responder - INFO - Alerta guardada en la base de datos: 31
2025-06-06 12:12:15,565 - responder - INFO - Alerta procesada: ICMP Ping | Src: 10.0.2.15 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP Bloqueada: 10.0.2.15
2025-06-06 12:12:15,566 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 12:12:15,568 - responder - INFO - Procesando nueva alerta: SSH Brute Force Attempt
2025-06-06 12:12:15,568 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T14:12:14.898030+0200",
  "flow_id": 1886686907269208,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "10.0.2.15",
  "src_port": 59306,
  "dest_ip": "192.168.56.4",
  "dest_port": 22,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000001,
    "rev": 2,
    "signature": "SSH Brute Force Attempt",
    "category": "Attempted Administrator Privilege Gain",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 58,
    "bytes_toclient": 0,
    "start": "2025-06-06T14:12:14.898030+0200",
    "src_ip": "10.0.2.15",
    "dest_ip": "192.168.56.4",
    "src_port": 59306,
    "dest_port": 22
  }
}
2025-06-06 12:12:15,569 - responder - INFO - IP 10.0.2.15 marcada para bloqueo por actividad maliciosa: SSH Brute Force Attempt
2025-06-06 12:12:15,569 - responder - INFO - Evaluando bloqueo para 10.0.2.15: categoria=Intento de fuerza bruta SSH, gravedad=3, should_block=True
2025-06-06 12:12:15,585 - responder - INFO - La IP 10.0.2.15 ya estaba bloqueada en iptables
2025-06-06 12:12:15,825 - responder - INFO - Alerta guardada en la base de datos: 32
2025-06-06 12:12:15,877 - responder - INFO - Alerta procesada: SSH Brute Force Attempt | Src: 10.0.2.15 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 10.0.2.15
2025-06-06 12:17:49,848 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:17:49,860 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:17:49.860330)
2025-06-06 12:17:49,860 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:17:49,860 - responder - INFO - Posici√≥n inicial del archivo: 29209
2025-06-06 12:17:49,868 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:17:49,871 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:17:49,960 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 12:17:49,961 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:21:16,779 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 12:21:16,870 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 12:21:16,870 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T14:21:16.656897+0200",
  "flow_id": 1132502630705610,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 37135,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T14:21:16.656897+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 37135,
    "dest_port": 80
  }
}
2025-06-06 12:21:16,872 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 12:21:16,919 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 12:21:17,165 - responder - INFO - Alerta guardada en la base de datos: 33
2025-06-06 12:21:17,219 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 12:21:17,802 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 12:21:17,842 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 12:21:17,865 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T14:21:17.760749+0200",
  "flow_id": 1578545300738762,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 37137,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T14:21:17.760749+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 37137,
    "dest_port": 80
  }
}
2025-06-06 12:21:17,866 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 12:21:17,916 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 12:21:18,109 - responder - INFO - Alerta guardada en la base de datos: 34
2025-06-06 12:21:18,175 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 12:21:18,189 - responder - INFO - Procesando nueva alerta: SSH Brute Force Attempt
2025-06-06 12:21:18,189 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T14:21:17.760753+0200",
  "flow_id": 1578559884674793,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 37137,
  "dest_ip": "192.168.56.4",
  "dest_port": 22,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000001,
    "rev": 2,
    "signature": "SSH Brute Force Attempt",
    "category": "Attempted Administrator Privilege Gain",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T14:21:17.760753+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 37137,
    "dest_port": 22
  }
}
2025-06-06 12:21:18,189 - responder - INFO - IP 192.168.56.5 marcada para bloqueo por actividad maliciosa: SSH Brute Force Attempt
2025-06-06 12:21:18,190 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Intento de fuerza bruta SSH, gravedad=3, should_block=True
2025-06-06 12:21:18,229 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 12:21:18,480 - responder - INFO - Alerta guardada en la base de datos: 35
2025-06-06 12:21:18,545 - responder - INFO - Alerta procesada: SSH Brute Force Attempt | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 12:26:53,412 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:26:53,423 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:26:53.423082)
2025-06-06 12:26:53,423 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:26:53,423 - responder - INFO - Posici√≥n inicial del archivo: 31080
2025-06-06 12:26:53,428 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:26:53,432 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:26:53,522 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 12:26:53,523 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:39:00,461 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:39:00,490 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:39:00.490614)
2025-06-06 12:39:00,495 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:39:00,495 - responder - INFO - Posici√≥n inicial del archivo: 31080
2025-06-06 12:39:00,541 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:39:00,561 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:39:00,637 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 12:39:00,649 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:42:11,845 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:42:11,846 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:42:11.846292)
2025-06-06 12:42:11,858 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:42:11,858 - responder - INFO - Posici√≥n inicial del archivo: 31080
2025-06-06 12:42:11,935 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:42:11,973 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:42:12,032 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 12:42:12,042 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:43:28,454 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:43:28,461 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:43:28.461828)
2025-06-06 12:43:28,462 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:43:28,462 - responder - INFO - Posici√≥n inicial del archivo: 31080
2025-06-06 12:43:28,534 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:43:28,564 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:43:28,568 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 12:43:28,571 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:51:16,634 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:51:16,634 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:51:16.634916)
2025-06-06 12:51:16,635 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:51:16,635 - responder - INFO - Posici√≥n inicial del archivo: 31080
2025-06-06 12:51:16,637 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:51:16,643 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:51:16,850 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 12:51:16,851 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 12:58:20,473 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 12:58:20,491 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T12:58:20.491205)
2025-06-06 12:58:20,491 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 12:58:20,491 - responder - INFO - Posici√≥n inicial del archivo: 31080
2025-06-06 12:58:20,500 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 12:58:20,520 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 12:58:20,580 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 12:58:20,581 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 13:03:42,063 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 13:03:42,065 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T13:03:42.065284)
2025-06-06 13:03:42,065 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 13:03:42,065 - responder - INFO - Posici√≥n inicial del archivo: 31080
2025-06-06 13:03:42,081 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 13:03:42,088 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 13:03:42,101 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 13:03:42,104 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 13:04:16,265 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 13:04:16,289 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 13:04:16,292 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T15:04:16.235936+0200",
  "flow_id": 168915808161237,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 62094,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T15:04:16.235936+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 62094,
    "dest_port": 80
  }
}
2025-06-06 13:04:16,292 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 13:04:16,425 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Actividad sospechosa]
2025-06-06 13:04:16,453 - responder - INFO - Intentando insertar IP 192.168.56.5 en la base de datos...
2025-06-06 13:04:16,506 - responder - INFO - IP 192.168.56.5 insertada correctamente en la base de datos
2025-06-06 13:04:16,653 - responder - INFO - IP 192.168.56.5 bloqueada correctamente en iptables
2025-06-06 13:04:16,675 - responder - ERROR - Error al ejecutar comando which iptables-persistent: Command '['which', 'iptables-persistent']' returned non-zero exit status 1.
2025-06-06 13:04:16,687 - responder - ERROR - Error al ejecutar comando which netfilter-persistent: Command '['which', 'netfilter-persistent']' returned non-zero exit status 1.
2025-06-06 13:04:16,716 - responder - INFO - Reglas de iptables guardadas correctamente
2025-06-06 13:04:16,719 - responder - INFO - IP 192.168.56.5 bloqueada correctamente
2025-06-06 13:04:16,720 - responder - WARNING - IP bloqueada autom√°ticamente: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port
2025-06-06 13:04:16,794 - responder - INFO - Alerta guardada en la base de datos: 36
2025-06-06 13:04:16,825 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP Bloqueada: 192.168.56.5
2025-06-06 13:05:57,597 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 13:05:57,598 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T13:05:57.598942)
2025-06-06 13:05:57,599 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 13:05:57,599 - responder - INFO - Posici√≥n inicial del archivo: 31698
2025-06-06 13:05:57,600 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 13:05:57,601 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 13:05:57,625 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 13:05:57,625 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 14:01:41,274 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 14:01:41,277 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T14:01:41.277260)
2025-06-06 14:01:41,277 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 14:01:41,284 - responder - INFO - Posici√≥n inicial del archivo: 31698
2025-06-06 14:01:41,298 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 14:01:41,310 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 14:01:41,409 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 14:01:41,410 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 14:03:28,162 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 14:03:28,163 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T14:03:28.163406)
2025-06-06 14:03:28,163 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 14:03:28,163 - responder - INFO - Posici√≥n inicial del archivo: 31698
2025-06-06 14:03:28,165 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 14:03:28,172 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 14:03:28,238 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 14:03:28,239 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 14:06:37,594 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 14:06:37,597 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T14:06:37.596987)
2025-06-06 14:06:37,597 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 14:06:37,597 - responder - INFO - Posici√≥n inicial del archivo: 31698
2025-06-06 14:06:37,599 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 14:06:37,601 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 14:06:37,646 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 14:06:37,646 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 14:08:55,307 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 14:08:55,366 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 14:08:55,366 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T16:08:55.263056+0200",
  "flow_id": 1974242016105584,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 42871,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T16:08:55.263056+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 42871,
    "dest_port": 80
  }
}
2025-06-06 14:08:55,367 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 14:08:55,384 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 14:08:55,474 - responder - INFO - Alerta guardada en la base de datos: 37
2025-06-06 14:08:55,497 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 14:08:55,497 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 14:08:55,497 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 14:08:55,498 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T16:08:55.355136+0200",
  "flow_id": 2088250252231292,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 42873,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T16:08:55.355136+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 42873,
    "dest_port": 80
  }
}
2025-06-06 14:08:55,500 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 14:08:55,510 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 14:08:55,596 - responder - INFO - Alerta guardada en la base de datos: 38
2025-06-06 14:08:55,619 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 14:11:38,075 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 14:11:38,077 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T14:11:38.077393)
2025-06-06 14:11:38,077 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 14:11:38,077 - responder - INFO - Posici√≥n inicial del archivo: 32936
2025-06-06 14:11:38,080 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 14:11:38,081 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 14:11:38,113 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 14:11:38,113 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 14:32:23,892 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 14:32:23,892 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T14:32:23.892643)
2025-06-06 14:32:23,892 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 14:32:23,892 - responder - INFO - Posici√≥n inicial del archivo: 32936
2025-06-06 14:32:23,897 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 14:32:23,902 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 14:32:23,929 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 14:32:23,930 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 14:33:48,748 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 14:33:48,750 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T14:33:48.750181)
2025-06-06 14:33:48,750 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 14:33:48,750 - responder - INFO - Posici√≥n inicial del archivo: 32936
2025-06-06 14:33:48,752 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 14:33:48,753 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 14:33:48,781 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-06 14:33:48,782 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 14:35:35,719 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 14:35:35,772 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 14:35:35,773 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T16:35:35.677084+0200",
  "flow_id": 2063629278444584,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 53056,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T16:35:35.677084+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 53056,
    "dest_port": 80
  }
}
2025-06-06 14:35:35,780 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 14:35:35,850 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 14:35:35,956 - responder - INFO - Alerta guardada en la base de datos: 39
2025-06-06 14:35:35,996 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 14:35:35,997 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 14:35:35,997 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 14:35:35,997 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T16:35:35.778332+0200",
  "flow_id": 2217012806391486,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 53058,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-06T16:35:35.778332+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 53058,
    "dest_port": 80
  }
}
2025-06-06 14:35:35,997 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad sospechosa, gravedad=2, should_block=True
2025-06-06 14:35:36,041 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-06 14:35:36,133 - responder - INFO - Alerta guardada en la base de datos: 40
2025-06-06 14:35:36,158 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 2 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-06 14:37:47,438 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 14:37:47,441 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T14:37:47.441403)
2025-06-06 14:37:47,441 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 14:37:47,441 - responder - INFO - Posici√≥n inicial del archivo: 34174
2025-06-06 14:37:47,443 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 14:37:47,446 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 14:37:47,474 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 14:37:47,474 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 17:04:29,254 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 17:04:29,255 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T17:04:29.255735)
2025-06-06 17:04:29,255 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 17:04:29,256 - responder - INFO - Posici√≥n inicial del archivo: 34174
2025-06-06 17:04:29,270 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 17:04:29,276 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 17:04:29,359 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 17:04:29,360 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 17:16:30,868 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 17:16:30,868 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T17:16:30.868832)
2025-06-06 17:16:30,869 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 17:16:30,869 - responder - INFO - Posici√≥n inicial del archivo: 36650
2025-06-06 17:16:30,870 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 17:16:30,871 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 17:16:30,900 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 17:16:30,900 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 17:18:44,577 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-06 17:18:44,577 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-06T17:18:44.577920)
2025-06-06 17:18:44,578 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-06 17:18:44,578 - responder - INFO - Posici√≥n inicial del archivo: 36650
2025-06-06 17:18:44,580 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-06 17:18:44,583 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-06 17:18:44,599 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-06 17:18:44,599 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-06 17:19:09,186 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 17:19:09,207 - responder - INFO - Procesando nueva alerta: ICMP Ping
2025-06-06 17:19:09,207 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T19:19:09.166831+0200",
  "flow_id": 1560962469623635,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "10.0.2.15",
  "dest_ip": "192.168.56.4",
  "proto": "ICMP",
  "icmp_type": 13,
  "icmp_code": 0,
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000009,
    "rev": 2,
    "signature": "ICMP Ping",
    "category": "Detection of a Network Scan",
    "severity": 3
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 54,
    "bytes_toclient": 0,
    "start": "2025-06-06T19:19:09.166831+0200",
    "src_ip": "10.0.2.15",
    "dest_ip": "192.168.56.4"
  }
}
2025-06-06 17:19:09,208 - responder - INFO - IP 10.0.2.15 marcada para bloqueo por actividad maliciosa: ICMP Ping
2025-06-06 17:19:09,210 - responder - INFO - Evaluando bloqueo para 10.0.2.15: categoria=Amenaza confirmada, gravedad=3, should_block=True
2025-06-06 17:19:09,240 - responder - INFO - Intentando bloquear IP: 10.0.2.15 - Raz√≥n: ICMP Ping [Amenaza confirmada]
2025-06-06 17:19:09,269 - responder - INFO - Regla aplicada: iptables -t raw -I PREROUTING 1 -s 10.0.2.15 -j DROP
2025-06-06 17:19:09,277 - responder - INFO - Regla aplicada: iptables -t filter -I INPUT 1 -s 10.0.2.15 -j DROP
2025-06-06 17:19:09,297 - responder - INFO - Regla aplicada: iptables -t filter -I FORWARD 1 -s 10.0.2.15 -j DROP
2025-06-06 17:19:09,317 - responder - INFO - Regla aplicada: iptables -t filter -I DOCKER-USER 1 -s 10.0.2.15 -j DROP
2025-06-06 17:19:09,325 - responder - INFO - Regla aplicada: iptables -t filter -I OUTPUT 1 -d 10.0.2.15 -j DROP
2025-06-06 17:19:09,332 - responder - INFO - IP 10.0.2.15 bloqueada exitosamente
2025-06-06 17:19:09,342 - responder - INFO - Reglas de iptables guardadas correctamente en /etc/iptables/rules.v4
2025-06-06 17:19:09,342 - responder - WARNING - IP bloqueada autom√°ticamente: 10.0.2.15 - Raz√≥n: ICMP Ping
2025-06-06 17:19:09,386 - responder - INFO - Alerta guardada en la base de datos: 41
2025-06-06 17:19:09,419 - responder - INFO - Alerta procesada: ICMP Ping | Src: 10.0.2.15 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP Bloqueada: 10.0.2.15
2025-06-06 17:19:09,419 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-06 17:19:09,424 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 17:19:09,427 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T19:19:09.260685+0200",
  "flow_id": 1682583578896847,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "10.0.2.15",
  "src_port": 64014,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 58,
    "bytes_toclient": 0,
    "start": "2025-06-06T19:19:09.260685+0200",
    "src_ip": "10.0.2.15",
    "dest_ip": "192.168.56.4",
    "src_port": 64014,
    "dest_port": 80
  }
}
2025-06-06 17:19:09,431 - responder - INFO - IP 10.0.2.15 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-06 17:19:09,441 - responder - INFO - Evaluando bloqueo para 10.0.2.15: categoria=Escaneo de puertos detectado, gravedad=3, should_block=True
2025-06-06 17:19:09,455 - responder - INFO - La IP 10.0.2.15 ya estaba bloqueada en iptables
2025-06-06 17:19:09,469 - responder - INFO - Alerta guardada en la base de datos: 42
2025-06-06 17:19:09,480 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 10.0.2.15 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 10.0.2.15
2025-06-06 17:19:09,480 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-06 17:19:09,480 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-06T19:19:09.365246+0200",
  "flow_id": 1568721538085959,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "10.0.2.15",
  "src_port": 64016,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 58,
    "bytes_toclient": 0,
    "start": "2025-06-06T19:19:09.365246+0200",
    "src_ip": "10.0.2.15",
    "dest_ip": "192.168.56.4",
    "src_port": 64016,
    "dest_port": 80
  }
}
2025-06-06 17:19:09,480 - responder - INFO - IP 10.0.2.15 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-06 17:19:09,480 - responder - INFO - Evaluando bloqueo para 10.0.2.15: categoria=Escaneo de puertos detectado, gravedad=3, should_block=True
2025-06-06 17:19:09,493 - responder - INFO - La IP 10.0.2.15 ya estaba bloqueada en iptables
2025-06-06 17:19:09,504 - responder - INFO - Alerta guardada en la base de datos: 43
2025-06-06 17:19:09,517 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 10.0.2.15 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 10.0.2.15
2025-06-07 10:22:41,576 - responder - INFO - Base de datos inicializada en /home/secnet/Descargas/secnet-v2-main/python-responder/database/alerts.db
2025-06-07 10:22:41,577 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T10:22:41.576978)
2025-06-07 10:22:41,577 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 10:22:41,577 - responder - INFO - Posici√≥n inicial del archivo: 1130761
2025-06-07 10:22:41,578 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 10:22:41,579 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 08:23:49,503 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 08:23:49,504 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T08:23:49.504387)
2025-06-07 08:23:49,504 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 08:23:49,505 - responder - INFO - Posici√≥n inicial del archivo: 38444
2025-06-07 08:23:49,507 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 08:23:49,508 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 08:23:49,533 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 08:23:49,533 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 08:25:25,230 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 08:25:25,230 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T08:25:25.230687)
2025-06-07 08:25:25,230 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 08:25:25,230 - responder - INFO - Posici√≥n inicial del archivo: 38444
2025-06-07 08:25:25,234 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 08:25:25,235 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 08:25:25,245 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 08:25:25,245 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 08:29:36,460 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 08:29:36,460 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T08:29:36.460527)
2025-06-07 08:29:36,460 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 08:29:36,461 - responder - INFO - Posici√≥n inicial del archivo: 38444
2025-06-07 08:29:36,464 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 08:29:36,471 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 08:29:36,495 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 08:29:36,495 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 08:32:18,268 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 08:32:18,271 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T08:32:18.271537)
2025-06-07 08:32:18,271 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 08:32:18,271 - responder - INFO - Posici√≥n inicial del archivo: 38444
2025-06-07 08:32:18,275 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 08:32:18,278 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 08:32:18,303 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-07 08:32:18,303 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 08:35:33,514 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 08:35:33,514 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T08:35:33.514752)
2025-06-07 08:35:33,514 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 08:35:33,515 - responder - INFO - Posici√≥n inicial del archivo: 38444
2025-06-07 08:35:33,543 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 08:35:33,558 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 08:35:33,681 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-07 08:35:33,681 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 08:36:39,477 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-07 08:36:39,499 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-07 08:36:39,502 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-07T10:36:39.435090+0200",
  "flow_id": 2150172771386244,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 41935,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-07T10:36:39.435090+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 41935,
    "dest_port": 80
  }
}
2025-06-07 08:36:39,502 - responder - INFO - IP 192.168.56.5 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-07 08:36:39,504 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Escaneo de puertos detectado, gravedad=3, should_block=True
2025-06-07 08:36:39,522 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Escaneo de puertos detectado]
2025-06-07 08:36:39,603 - responder - INFO - IP 192.168.56.5 registrada en la base de datos
2025-06-07 08:36:39,758 - responder - INFO - IP 192.168.56.5 bloqueada exitosamente
2025-06-07 08:36:39,786 - responder - ERROR - No se pudo verificar el bloqueo de la IP 192.168.56.5
2025-06-07 08:36:39,786 - responder - ERROR - No se pudo bloquear la IP: 192.168.56.5
2025-06-07 08:36:39,857 - responder - INFO - Alerta guardada en la base de datos: 44
2025-06-07 08:36:39,874 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: Error bloqueando IP: 192.168.56.5
2025-06-07 08:36:39,879 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-07 08:36:39,879 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-07 08:36:39,879 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-07T10:36:39.526922+0200",
  "flow_id": 1981639570080117,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 41937,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-07T10:36:39.526922+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 41937,
    "dest_port": 80
  }
}
2025-06-07 08:36:39,880 - responder - INFO - IP 192.168.56.5 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-07 08:36:39,880 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Escaneo de puertos detectado, gravedad=3, should_block=True
2025-06-07 08:36:39,907 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Escaneo de puertos detectado]
2025-06-07 08:36:40,093 - responder - INFO - IP 192.168.56.5 bloqueada exitosamente
2025-06-07 08:36:40,124 - responder - ERROR - No se pudo verificar el bloqueo de la IP 192.168.56.5
2025-06-07 08:36:40,127 - responder - ERROR - No se pudo bloquear la IP: 192.168.56.5
2025-06-07 08:36:40,204 - responder - INFO - Alerta guardada en la base de datos: 45
2025-06-07 08:36:40,225 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: Error bloqueando IP: 192.168.56.5
2025-06-07 08:39:53,112 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 08:39:53,115 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T08:39:53.115966)
2025-06-07 08:39:53,116 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 08:39:53,116 - responder - INFO - Posici√≥n inicial del archivo: 39682
2025-06-07 08:39:53,118 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 08:39:53,119 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 08:39:53,146 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-07 08:39:53,146 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 08:41:38,196 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-07 08:41:38,214 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-07 08:41:38,215 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-07T10:41:38.155395+0200",
  "flow_id": 667420278618101,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 38537,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-07T10:41:38.155395+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 38537,
    "dest_port": 80
  }
}
2025-06-07 08:41:38,215 - responder - INFO - IP 192.168.56.5 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-07 08:41:38,215 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Escaneo de puertos detectado, gravedad=3, should_block=True
2025-06-07 08:41:38,243 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Escaneo de puertos detectado]
2025-06-07 08:41:38,473 - responder - INFO - IP 192.168.56.5 bloqueada exitosamente
2025-06-07 08:41:38,507 - responder - ERROR - No se pudo verificar el bloqueo de la IP 192.168.56.5
2025-06-07 08:41:38,508 - responder - ERROR - No se pudo bloquear la IP: 192.168.56.5
2025-06-07 08:41:38,624 - responder - INFO - Alerta guardada en la base de datos: 46
2025-06-07 08:41:38,672 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: Error bloqueando IP: 192.168.56.5
2025-06-07 08:41:38,676 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-07 08:41:38,678 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-07 08:41:38,680 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-07T10:41:38.255707+0200",
  "flow_id": 816780977472163,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 38539,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-07T10:41:38.255707+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 38539,
    "dest_port": 80
  }
}
2025-06-07 08:41:38,680 - responder - INFO - IP 192.168.56.5 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-07 08:41:38,680 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Escaneo de puertos detectado, gravedad=3, should_block=True
2025-06-07 08:41:38,713 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Escaneo de puertos detectado]
2025-06-07 08:41:38,909 - responder - INFO - IP 192.168.56.5 bloqueada exitosamente
2025-06-07 08:41:38,944 - responder - ERROR - No se pudo verificar el bloqueo de la IP 192.168.56.5
2025-06-07 08:41:38,958 - responder - ERROR - No se pudo bloquear la IP: 192.168.56.5
2025-06-07 08:41:39,090 - responder - INFO - Alerta guardada en la base de datos: 47
2025-06-07 08:41:39,114 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: Error bloqueando IP: 192.168.56.5
2025-06-07 08:44:37,929 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 08:44:37,935 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T08:44:37.935529)
2025-06-07 08:44:37,935 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 08:44:37,936 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 08:44:37,939 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 08:44:37,941 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 08:44:38,006 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 08:44:38,007 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:23:12,891 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:23:12,891 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:23:12.891572)
2025-06-07 11:23:12,891 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:23:12,891 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 11:23:12,895 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:23:12,896 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:23:12,946 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 11:23:12,946 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:25:41,170 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:25:41,170 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:25:41.170676)
2025-06-07 11:25:41,170 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:25:41,171 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 11:25:41,181 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:25:41,192 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:25:41,255 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 11:25:41,256 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:29:22,670 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:29:22,671 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:29:22.671296)
2025-06-07 11:29:22,671 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:29:22,671 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 11:29:22,673 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:29:22,676 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:29:22,714 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 11:29:22,714 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:30:27,581 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:30:27,581 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:30:27.581578)
2025-06-07 11:30:27,581 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:30:27,581 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 11:30:27,583 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:30:27,586 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:30:27,629 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 11:30:27,630 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:36:10,478 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:36:10,478 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:36:10.478445)
2025-06-07 11:36:10,478 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:36:10,478 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 11:36:10,480 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:36:10,484 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:36:10,527 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 11:36:10,527 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:37:17,731 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:37:17,733 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:37:17.733491)
2025-06-07 11:37:17,733 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:37:17,734 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 11:37:17,735 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:37:17,736 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:37:17,823 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-07 11:37:17,824 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:40:30,709 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:40:30,712 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:40:30.712021)
2025-06-07 11:40:30,712 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:40:30,712 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 11:40:30,714 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:40:30,715 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:40:30,797 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 11:40:30,797 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:42:26,056 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:42:26,059 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:42:26.059143)
2025-06-07 11:42:26,059 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:42:26,059 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 11:42:26,061 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:42:26,062 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:42:26,145 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-07 11:42:26,145 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:46:43,431 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:46:43,432 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:46:43.432065)
2025-06-07 11:46:43,432 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:46:43,432 - responder - INFO - Posici√≥n inicial del archivo: 40918
2025-06-07 11:46:43,450 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:46:43,452 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:46:43,605 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.56.4:5000
2025-06-07 11:46:43,608 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-06-07 11:47:57,234 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-07 11:47:57,256 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-07 11:47:57,261 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-07T11:47:57.214068+0200",
  "flow_id": 1482368587952555,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 53325,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-07T11:47:57.214068+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 53325,
    "dest_port": 80
  }
}
2025-06-07 11:47:57,267 - responder - INFO - IP 192.168.56.5 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-07 11:47:57,270 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad de red normal, gravedad=3, should_block=True
2025-06-07 11:47:57,405 - responder - WARNING - IP 192.168.56.5 aparece en las reglas pero no est√° completamente bloqueada (reglas encontradas: 1/7)
2025-06-07 11:47:57,408 - responder - INFO - Intentando bloquear IP: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port [Actividad de red normal]
2025-06-07 11:47:57,509 - responder - WARNING - IP 192.168.56.5 aparece en las reglas pero no est√° completamente bloqueada (reglas encontradas: 1/7)
2025-06-07 11:47:57,575 - responder - INFO - IP 192.168.56.5 registrada en la base de datos
2025-06-07 11:47:57,649 - responder - INFO - Ejecutando script de bloqueo para 192.168.56.5
2025-06-07 11:47:58,026 - responder - ERROR - Errores del script de bloqueo: + set -e
+ echo 'Aplicando regla: iptables -t raw -I PREROUTING 1 -s 192.168.56.5 -j DROP'
+ iptables -t raw -I PREROUTING 1 -s 192.168.56.5 -j DROP
+ echo 'Aplicando regla: iptables -I INPUT 1 -s 192.168.56.5 -j DROP'
+ iptables -I INPUT 1 -s 192.168.56.5 -j DROP
+ echo 'Aplicando regla: iptables -I FORWARD 1 -s 192.168.56.5 -j DROP'
+ iptables -I FORWARD 1 -s 192.168.56.5 -j DROP
+ echo 'Aplicando regla: iptables -I FORWARD 1 -d 192.168.56.5 -j DROP'
+ iptables -I FORWARD 1 -d 192.168.56.5 -j DROP
+ echo 'Aplicando regla: iptables -I OUTPUT 1 -d 192.168.56.5 -j DROP'
+ iptables -I OUTPUT 1 -d 192.168.56.5 -j DROP
+ echo 'Aplicando regla: iptables -I DOCKER-USER 1 -s 192.168.56.5 -j DROP'
+ iptables -I DOCKER-USER 1 -s 192.168.56.5 -j DROP
+ echo 'Aplicando regla: iptables -I DOCKER-USER 1 -d 192.168.56.5 -j DROP'
+ iptables -I DOCKER-USER 1 -d 192.168.56.5 -j DROP
+ echo 'Aplicando regla: iptables -I INPUT 1 -p icmp -s 192.168.56.5 -j DROP'
+ iptables -I INPUT 1 -p icmp -s 192.168.56.5 -j DROP
+ echo 'Aplicando regla: iptables -I INPUT 1 -m conntrack --ctstate ESTABLISHED,RELATED -s 192.168.56.5 -j DROP'
+ iptables -I INPUT 1 -m conntrack --ctstate ESTABLISHED,RELATED -s 192.168.56.5 -j DROP
+ echo 'Aplicando regla: iptables -t mangle -I PREROUTING 1 -s 192.168.56.5 -j DROP'
+ iptables -t mangle -I PREROUTING 1 -s 192.168.56.5 -j DROP
+ echo 'Guardando reglas de iptables...'
+ command -v iptables-save
+ iptables-save
+ echo 'Reglas guardadas en /etc/iptables/rules.v4'
+ command -v netfilter-persistent
+ netfilter-persistent save
+ echo 'Reglas guardadas con netfilter-persistent'
+ echo 'Bloqueo completado exitosamente'

2025-06-07 11:47:58,028 - responder - INFO - Script de bloqueo para 192.168.56.5 ejecutado exitosamente
2025-06-07 11:47:58,028 - responder - INFO - Verificando bloqueo de 192.168.56.5...
2025-06-07 11:47:58,143 - responder - INFO - IP 192.168.56.5 bloqueada exitosamente
2025-06-07 11:47:58,143 - responder - INFO - Guardando reglas de iptables...
2025-06-07 11:47:58,164 - responder - INFO - Reglas guardadas usando: iptables-save
2025-06-07 11:47:58,166 - responder - INFO - Reglas de iptables guardadas correctamente en /etc/iptables/rules.v4
2025-06-07 11:47:58,476 - responder - WARNING - IP bloqueada autom√°ticamente: 192.168.56.5 - Raz√≥n: SYN Scan to HTTP port
2025-06-07 11:47:58,661 - responder - INFO - Alerta guardada en la base de datos: 48
2025-06-07 11:47:58,687 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP Bloqueada: 192.168.56.5
2025-06-07 11:47:58,688 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-07 11:47:58,689 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-07 11:47:58,691 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-07T11:47:57.313216+0200",
  "flow_id": 1626729557526217,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 53327,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-07T11:47:57.313216+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 53327,
    "dest_port": 80
  }
}
2025-06-07 11:47:58,694 - responder - INFO - IP 192.168.56.5 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-07 11:47:58,694 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad de red normal, gravedad=3, should_block=True
2025-06-07 11:47:58,806 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-07 11:47:58,885 - responder - INFO - Alerta guardada en la base de datos: 49
2025-06-07 11:47:58,907 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-07 11:48:54,397 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-07 11:48:54,399 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-07 11:48:54,399 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-07T11:48:54.385915+0200",
  "flow_id": 1938967390088135,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 54330,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-07T11:48:54.385915+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 54330,
    "dest_port": 80
  }
}
2025-06-07 11:48:54,399 - responder - INFO - IP 192.168.56.5 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-07 11:48:54,400 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad de red normal, gravedad=3, should_block=True
2025-06-07 11:48:54,507 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-07 11:48:54,578 - responder - INFO - Alerta guardada en la base de datos: 50
2025-06-07 11:48:54,599 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-07 11:48:54,601 - responder - INFO - Archivo modificado: /var/log/suricata/eve.json
2025-06-07 11:48:54,601 - responder - INFO - Procesando nueva alerta: SYN Scan to HTTP port
2025-06-07 11:48:54,605 - responder - INFO - Procesando alerta: {
  "timestamp": "2025-06-07T11:48:54.486064+0200",
  "flow_id": 1806154010214226,
  "in_iface": "eth0",
  "event_type": "alert",
  "src_ip": "192.168.56.5",
  "src_port": 54332,
  "dest_ip": "192.168.56.4",
  "dest_port": 80,
  "proto": "TCP",
  "pkt_src": "wire/pcap",
  "alert": {
    "action": "allowed",
    "gid": 1,
    "signature_id": 1000011,
    "rev": 3,
    "signature": "SYN Scan to HTTP port",
    "category": "Attempted Information Leak",
    "severity": 2
  },
  "direction": "to_server",
  "flow": {
    "pkts_toserver": 1,
    "pkts_toclient": 0,
    "bytes_toserver": 60,
    "bytes_toclient": 0,
    "start": "2025-06-07T11:48:54.486064+0200",
    "src_ip": "192.168.56.5",
    "dest_ip": "192.168.56.4",
    "src_port": 54332,
    "dest_port": 80
  }
}
2025-06-07 11:48:54,607 - responder - INFO - IP 192.168.56.5 marcada para bloqueo por actividad maliciosa: SYN Scan to HTTP port
2025-06-07 11:48:54,607 - responder - INFO - Evaluando bloqueo para 192.168.56.5: categoria=Actividad de red normal, gravedad=3, should_block=True
2025-06-07 11:48:54,744 - responder - INFO - La IP 192.168.56.5 ya estaba bloqueada en iptables
2025-06-07 11:48:54,805 - responder - INFO - Alerta guardada en la base de datos: 51
2025-06-07 11:48:54,856 - responder - INFO - Alerta procesada: SYN Scan to HTTP port | Src: 192.168.56.5 | Dest: 192.168.56.4 | Severidad: 3 | Acci√≥n: IP ya bloqueada: 192.168.56.5
2025-06-07 11:50:32,931 - responder - INFO - Base de datos inicializada en /app/database/alerts.db
2025-06-07 11:50:32,933 - responder - INFO - Iniciando monitoreo de eventos nuevos (desde 2025-06-07T11:50:32.933715)
2025-06-07 11:50:32,933 - responder - INFO - Monitoreando archivo: /var/log/suricata/eve.json
2025-06-07 11:50:32,934 - responder - INFO - Posici√≥n inicial del archivo: 43394
2025-06-07 11:50:32,936 - responder - INFO - Observer iniciado: vigilando /var/log/suricata/eve.json
2025-06-07 11:50:32,937 - responder - INFO - Servidor Flask iniciado en el puerto 5000
2025-06-07 11:50:33,028 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.0.2.15:5000
2025-06-07 11:50:33,028 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
